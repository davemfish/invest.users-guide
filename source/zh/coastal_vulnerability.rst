.. _海岸线脆弱性:

***************************
海岸脆弱性模型
***************************

摘要
=======

面对人类活动的加剧和气候的变化，沿海社区需要更好地了解生物和物理环境的改变(即为了沿海发展直接和间接地拆除自然栖息地)会如何影响他们受到风暴引起的侵蚀和洪水(淹没)的影响。InVEST海岸脆弱性模型根据脆弱性指数对这种风险进行了定性估计，该指数区分了在风暴期间遭受侵蚀和洪水的风险相对较高或较低的地区。通过将这些结果与全球人口信息相结合，该模型可以显示特定海岸线上人类最容易受到风暴潮影响的地区。该模型没有考虑到一个地区特有的海岸过程，也没有预测海岸线位置或其配置的长期或短期变化。

模型输入作为影响受侵蚀和洪水影响的各种复杂海岸线过程的代理，包括:含有沿着海岸线的当地海岸地貌属性的一条折线，表示自然栖息地(如海草、海带、湿地等)位置的多边形，(观测到的)海平面净变化率，可以用作风浪水位指示器的深度等高线(默认等高线是大陆的边缘)，代表沿海地区地形的数字高程模型(DEM)，包含观测到的风暴风速和波浪功率值的点形文件，以及一个表示人口分布的栅格。

输出可用于更好地理解这些不同模型变量对沿海曝光的相对贡献，并突出自然栖息地对沿海人口提供的保护服务。这些信息可以帮助沿海管理者、规划者、土地所有者和其他利益攸关方确定沿海灾害风险较大的地区，从而更好地为开发战略和许可提供信息。输出结果提供了海岸灾害风险的定性表示，而不是量化海岸线后退或淹没极限。


简介
============

沿海地区经常受到海浪和风暴的影响，自然会经历不同时间和空间尺度的侵蚀和淹没。然而，海岸侵蚀和洪水对人类人口、活动和基础设施构成威胁，特别是在气候变化和沿海人口增加的情况下。此外，这些人为压力的增加会导致沿海生态系统及其在风暴期间为人类提供保护的能力的丧失和退化。因此，了解各种生物和物理因素在增加或减少海岸侵蚀和洪水威胁方面的作用是很重要的，以便更好地规划未来的发展。尤其重要的是，要知道自然栖息地如何能减轻造成海岸侵蚀和淹没的力量，以便采取管理行动最好地保存海岸生态系统提供的保护服务。

许多模型都是基于地球物理特征（长期海平面上升、侵蚀和淹没）估计沿海地区的脆弱性(Gornitz et al. 1991, Hammar-Klose and Thieler 2001, Cooper and McLaughlin 1998)。也有一些方法定性地估计了自然栖息地在降低特定地区侵蚀和淹没风险方面的相对作用(WRI 2009, Bush et al. 2001)。然而，很少有模型根据一个地区的地理和自然栖息地特征绘制沿海地区对侵蚀和洪水的相对脆弱性。我们的目标是用海岸脆弱性模型填补这一空白。 

海岸脆弱性模型产生了海岸受侵蚀和洪水影响的定性指数，并总结了海岸线附近的人口密度。该模型不直接评估任何生态服务的价值，而是按照侵蚀和淹没风险相对较低、中等或较高的地点进行排名。它使用起来相对简单，运行起来也很快，而且它可以应用在世界上大多数地区，其数据在大多数情况下相对容易获得。

模型输出是地理空间数据集，具有建模师定义的空间分辨率，可以与其他空间信息叠加，供用户根据需要进行进一步分析。通过强调自然栖息地在减少曝光方面的相对作用，并显示受到沿海人口威胁的地区，该模型可用于调查一些管理行动或土地使用变化如何影响人类人口对侵蚀和洪水的威胁。

.. _海岸脆弱性模型:

模型
=========

InVEST沿海脆弱性模型按用户指定的间隔为沿海岸线的每个点生成曝光指数排名。曝光指数表示不同海岸线段对有关区域内风暴造成的侵蚀和淹没的相对曝光程度。沿海人口栅格显示有关沿海地区的人口密度分布。该指数由多达7个生物地理变量组成。这些变数代表了整个区域的自然生物和地貌特征的变化、海平面上升的速度或数量、当地的水深和地形，以及与风暴有关的相对风和海浪的强迫力。该模型评估研究区内每个海岸段相对于所有其他海岸段的曝光程度。根据输入数据的分辨率，模型输出在各种规模和程度上都可能是相关的。该模型适用于宽阔的、裸露的、均匀的海岸线，也适用于复杂的、异质性的、受保护的海岸线。最后，该模型还总结了与曝光指数相同尺度上的沿海人口密度，可用于创建显示人口对沿海风暴的相对脆弱性的地图。

运行原理
------------

该模型使用下列生物地理变量的空间表示来计算曝光指数和沿海人口密度:

1.  地形起伏
2.  自然栖息地(生物和非生物)
3.  风曝光
4.  海浪曝光
5.  潜在巨浪深度轮廓线
6.  地貌（可选）
7.  海平面变化（可选）


该模型的主要输出是一个地理空间数据集(点)，这些数据集是沿着沿海研究区的海岸线以用户定义的间隔绘制。这个点数据集包括一个表，其中包含输入许多目录和输入变量的排名(如下所述)，可以用于创建满足用户需求的地图。下面详细描述了模型变量以及如何创建输出。

.. _exposure-index:

曝光指数
^^^^^^^^^^^^^^

该模型通过将每个岸线点上多达7个生物和物理变量排列组合起来，计算出沿海暴光指数。根据用户和模型定义的混合标准，等级从**极低曝光率(排名=1)**到**极高曝光率(排名=5)**不等。该排名系统基于Gornitz等人(1990)和Hammar-Klose和Thieler(2001)提出的方法。

.. csv-table:: **样例排行表**
      :file: ../en/coastal_vulnerability/ranking_system_table.csv
      :header-rows: 1
      :name: ranking-table

|

该模型计算每个海岸线点的曝光指数EI作为所有变量排名的几何平均值:

.. math:: EI = \left ({R_{Geomorphology} R_{Relief} R_{Habitats} R_{SLR} R_{WindExposure} R_{WaveExposure} R_{Surge}} \right )^{1/7}
   :label: VulInd

或者更笼统地: 

.. math:: EI = \left (\prod_{i=1}^{n}R_i \right )^{1/n}
   :label: VulInd_i

式中`R_i`表示计算`EI`的生物地理变量`i^{th}`的排序。

此外，我们提供了由模型计算的所有中间结果的表格输出，因此用户可以使用`R`变量的不同子集，甚至不同的方程，计算ÈI 。

在本节的其余部分中，我们首先描述研究区和海岸线点是如何定义的，然后对:ref:`ranking-table` 中给出的变量进行更详细的描述。

.. _海岸脆弱性-海岸点:

滨海研究区域
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

用户可以模拟任何尺度及全球南纬65°和北纬77°内的任何海岸线的海岸暴露(有关这一限制的详细信息，请参阅:ref:`cv-Wind`)。该模型需要一个多边形矢量来表示兴趣区域内的斑块。根据这个斑块，模型沿着海岸线绘制点，绘制的距离间隔由用户指定为**模型分辨率**。对于下面各节中描述的所有变量，模型为每个海岸点分配一个值。模型运行时间高度依赖于斑块多边形的细节水平，这与模型分辨率一起影响总海岸线点的数量。

在**研究区**多边形内，将沿着斑块多边形的所有线段绘制海岸点。用户可能希望排除小型的无人居住的近海特征，因为在这些特征中，评估海岸风险暴露没有意义。在评估对其他海岸点的风浪暴露的过程中，这些特征*将*仍然存在。

.. _海岸脆弱性-地貌:

地貌
^^^^^^^^^^^^^

与悬崖、海滩或三角洲相比，岩石悬崖不太容易受到侵蚀和淹没。因此，采用了类似于Hammar-Klose和Thieler(2001)提出的基于地貌的相对曝光排序方案。在:ref:`cv-appendix-a` 中提供了本分类中使用的术语的定义，该定义主要适用于北美大陆。

地貌输入应该是一个多线向量，其中包含分段，在一个名为“RANK”的属性字段中，根据:ref:`ranking-table` 中提供的方案对海岸线地貌进行分类。该模型以**模型分辨率**的一半为半径在每个点周围搜索，然后取搜索中发现的所有地貌等级的平均值，从而将地貌等级与岸边点连接起来。如果在搜索中没有找到地貌段，则将为**地貌填充值**选择的秩分配给该点。在本例中，接收到**地貌填充值**的岸边点被保存到一个中间输出文件中以方便使用。(*intermediate/geomorphology/shore_points_missing_geomorphology.gpkg*) 如果有很多点缺少数据，这可能是由于地形或陆地多边形输入的空间不准确造成的。在GIS中编辑其中一个或两个的几何图形可以帮助解决这个问题。

如果用户的地貌数据源比:ref:`ranking-table` 中提供的类别更多，则由用户自行决定对其数据进行重分类，以匹配所提供的排名系统，如:ref:`cv-data-needs` 部分和:ref:`cv-appendix-b` 中所解释的那样。

建议用户将海岸平行硬结构(海堤、隔板等)包括在此分类中，并根据其特性应用低到中等级别(1-3)。例如，一个大型的混凝土海堤应该被指定为1级，因为它们通常是为了在风暴事件中防止被淹没，并在最强大的风暴中承受破坏或故障。建议低护岸或抛石墙被指定为3级，因为它们不能防止洪水，并可能在极端事件中损坏。

上表中的排名只是一个建议。用户应该根据当地的研究和知识，按照:ref:`cv-data-needs` 部分给出的说明，根据他们认为合适的情况，改变不同海岸线类型的排名。

.. _海岸脆弱性-地形起伏:

地形起伏
^^^^^^^^

平均而言，海拔高于平均海平面(MSL)的地区比海拔较低的地区被淹没的风险更低。在模型中，地形起伏被定义为每个海岸点周围用户定义的**平均高程半径**内的沿海陆地区域的平均高程。对于这个变量，模型需要一个数字高程模型(DEM)，该模型覆盖整个研究区，并至少延伸到AOI之外的高程平均半径的距离。

如果在岸边点的搜索半径内没有有效的DEM像素，该点将不会获得地形起伏等级，也不会计算该点的最终曝光指数，因为等式:eq:`VulInd` 缺少一个关键变量(*R_relief*)。这些缺失的值将明显出现在**coastal_exposure.csv** 和**intermediate_exposure.csv** 输出文件中。如果有很多缺失值，用户可能希望增加**高程平均半径** 或确认DEM和陆地体多边形输入是互相匹配的。



.. _海岸脆弱性-自然栖息地:

自然栖息地
^^^^^^^^^^

自然栖息地(沼泽、海草床、红树林、海岸沙丘或其他)在减少海岸灾害的影响方面发挥着至关重要的作用，这些灾害可能侵蚀海岸线和伤害沿海社区。例如，大浪在到达海岸线之前就在珊瑚礁上破碎，红树林和沿海森林极大地降低了浅水区的浪高，并降低了由海浪和风产生的海流的强度，海草床和沼泽稳定了沉积物，促进了近岸床的积累，并消散了海浪的能量。另一方面，没有生物栖息地或沙丘的海滩几乎无法抵御侵蚀和洪水。

为了计算给定海岸线点的自然栖息地暴露等级，该模型确定某一类自然栖息地(:ref:`ranking-table`)是否在从该点开始的用户定义搜索半径内。(关于模型如何处理自然栖息地输入图层的描述，请参见第2节和:ref:`cv-appendix-b`)。当该点附近的所有生境`N`被识别出来后，模型创建一个数组*R*，其中包含与这些生境相关的所有秩`R_{k}, 1 \le k \le N`，如:ref:`ranking-table` 中定义的那样。利用这些等级值，模型计算出该点的最终*自然栖息地*暴露等级，公式如下:

.. math:: R_{Hab} = 4.8-0.5 \sqrt{ ( 1.5 \max_{k=1}^N (5-R_k) )^2 + \sum_{k=1}^N (5-R_k)^2 - (\max_{k=1}^N (5-R_k) )^2}
   :label: r_hab

其中排名最低的生境的权重是同一段附近所有其他生境的1.5倍。这一提法使我们能够最大限度地考虑到所有滨岸线前的自然栖息地所提供的保护服务。换句话说，它确保了正面或只有一种生境(例如，高沙丘)的部分比有多种生境(例如，珊瑚礁和高沙丘)的部分暴露的更多。参见:ref:`cv-appendix-b` 获得所有可能的最终排名值的详细说明，这些值可以通过方程:eq:`r_hab` 获得。

为了在曝光指数计算中包括这一变量，该模型需要地图层(栅格或矢量)，表示每种自然栖息地类型、栖息地提供的保护等级或水平，以及保护距离，超过这个距离栖息地就不能保护海岸线。所有这些参数都在**生境表(CSV)**中指定(参见:ref:`cv-data-needs` 下的生境表部分)。

在:ref:`ranking-table` 中提出的排名基于这样一个事实，即穿透水柱(如珊瑚礁、红树林)和沙丘等固定和坚硬的栖息地是保护沿海社区最有效的。灵活和季节性的栖息地，如海草，当它们能够承受水流的力量时，会减少水流，并促进沉积物的积累。因此，这些生境的排名低于固定生境。将沙丘分为高和低的类别是由用户自行决定的。然而，据建议，由于4级飓风可以产生5米的浪高，5米是区分高(>5米)和低(<5米)沙丘的适当临界值。如果用户知道研究区内哪些栖息地和沙丘海拔能提供更好的保护，他们应该调整:ref:`ranking-table` 中的值。

.. _海岸脆弱性-风:

风曝光
^^^^^^

强风如果吹过一个地区足够长的时间，就会产生高浪涌和/或强大的波浪。风曝光变量是根据相对暴露于强风的海岸线分段进行排名的输出。我们根据Keddy在1982年定义的相对暴露指数(REI)计算这个变量。该指数的计算方法是，从长期的风速测量记录中选取最高的10%的风速，将刻度盘(或360度罗盘)分成16个等角扇区，并将这些扇区的风和气流特征进行组合:

.. math:: REI = { {\sum^{16}_{n=1}} {U_n P_n F_n} }
   :label: REi

式中:

+ `U_n` 是`n^{th}`等角扇区最高10%风速的平均风速，单位为米/秒
+ `P_n` 是有兴趣的记录中吹向n扇区方向的所有风速的百分比
+ `F_n` 是在n扇区抵达距离(风吹过水面的距离)，单位为米

为了估计给定海岸点的抵达距离，该模型向16个方向投射光线，并测量光线与陆地相交前的最大长度。**最大抵达距离** 参数用于避免在整个海洋中投射光线。

.. note::
  关于风速和风向的数据也被用于计算“海浪曝光”变量，来自“Wave Watch III”数据集，并在InVEST安装附带的样本数据中提供。该数据集的空间覆盖范围限制了沿海脆弱性模型在南纬65°和北纬77°范围内的应用。然而，用户可以用自己的风速和风向数据代替Wave Watch III数据集。注意，在这个模型中，风向是风吹来的方向，而不是吹向的方向。如果用户提供他们自己的数据，在将这些数据应用到该模型之前，他们必须确保数据与此约定匹配。如果您希望提供自己的数据集，请参见:ref:`cv-appendix-b` 了解数据格式要求。

.. _海岸脆弱性-海浪:

海浪曝光
^^^^^^^^^^^^^

一段海岸线对风暴波的相对曝光是海岸线侵蚀潜力的一个定性指标。一段特定的海岸线通常暴露在海浪或当地产生的风力驱动的海浪中。同样，对于给定的波高，周期较长的波比较短的波具有更大的能量。暴露在开阔海域的海岸通常比遮蔽区域更容易受到海浪的影响，因为风吹过很远的距离，会产生更大的海浪。此外，暴露的区域会受到由遥远的风暴产生的长周期波或涌浪的影响。

该模型通过指定海浪加权平均功率的最大值`E_w^o`和当地风力产生的波浪`E_w^l`，来估计海岸线点对波浪的相对暴露量`E_w`: 

.. math:: E_w=\max(E_w^o,E_w^l)
   :label: Ew

对于海浪，加权平均功率计算为: 

.. math:: E_w^o=\sum_{k=1}^{16}H[F_k]P_k^o O_k^o
   :label: Ewo

式中， `H[F_k]` 是所有16个风等角扇区*k* 的heaviside阶跃函数。如果该方向上的取值小于**最大取值距离**，则为0，如果该方向上的取值等于**最大取值距离**，则为1:

.. math:: H[F_k]=\begin{cases}
   0 & \text{ if } F_k < max fetch distance \\
   1 & \text{ if } F_k = max fetch distance
   \end{cases}
   :label: HF

换句话说，对于接收距离等于**最大接收距离**的扇区，此函数仅在某一海岸点累积海浪曝光。例如，如果一个点被遮蔽在一个海湾中，并且没有任何抵达射线(在风暴露中描述过)达到**最大抵达距离**，那么`E_w^o`将保持0。此外，`P_k^o O_k^o`是在角扇区*k*方向上观测到的最高10%波功率值(`P_k^o`)的平均值，用在该扇区观察到这些波的时间百分比(`O_k^o`)进行加权。对于每个角扇区的所有波，波能计算为:

.. math:: P = \frac{1}{2} H^2 T
   :label: WavPow

式中，`P [kW/m]`是观测到的高度为`H [m]`，周期为`T [s]`的海波的功率。

对于局部风产生的波浪，`E_w^l` 计算为:

.. math:: E_w^l=\sum_{k=1}^{16} H[F_k] P_k^l O_k^l
   :label: Ewl

式中，`H[F_k]` 与:eq:`HF` 中的定义相反，这意味着:math:`E_w^l` 只会沿着*未* 达到**最大抵达距离** 的射线累积。

:math:`E_w^l` 是向*k*方向传播的最高10%的风速值:math:`P_k^l` 的平均值所产生的波浪功率在16个风扇区的总和，由该扇区中这些强风出现的百分比:math:`O_k^l` 加权。

利用“WavPow”方程估算了局部风生波的功率。本地产生的风波的波高和周期计算如下: 

.. math::
   \left\{\begin{matrix}
   H=\widetilde{H}_\infty \left[\tanh \left(0.343\widetilde{d}^{1.14} \right )  \tanh \left( \frac{4.41 \cdot 10^{-4}\widetilde{F}^{0.79}}{\tanh (0.343 \widetilde{d}^{1.14})} \right )\right ]^{0.572}\\
    \displaystyle \\
   T=\widetilde{T}_\infty \left[\tanh \left(0.1\widetilde{d}^{2.01} \right )  \tanh \left( \frac{2.77 \cdot 10^{-7}\widetilde{F}^{1.45}}{\tanh (0.1  \widetilde{d}^{2.01})} \right )\right ]^{0.187}
   \end{matrix}\right.
   :label: WaveFetch

式中无量纲的波高和周期`\widetilde{H}_\infty` 和`\widetilde{T}_\infty` 是在某一特定区域观测到的最高10%风速值Ù [m/s]的平均值的函数`\widetilde{H}_\infty=0.24U^2/g` 和`\widetilde{T}_\infty=7.69U/g`, 并且，式中无量纲的抵达和深度`\widetilde{F}_\infty` 和`\widetilde{d}_\infty`, 是该扇区抵达距离`F [m]`和研究区域的平均水深`d [m]`的函数: `\widetilde{F}_\infty=gF/U^2` 和`\widetilde{d}_\infty = gd/U^2`。`g [m/s^2]` 是重力加速度。

这个波高和周期的表达式假设抵达有限的条件，作为风速`U`向抵达`F`方向稳定吹的持续时间(USACE, 2002; 第二部分第二章);因此，模型结果可能会高估某一地点的风生波特征。

作为InVEST下载包的一部分，存在一个shapefile，其中包含从WAVEWATCH III (WW3, Tolman(2009)) 8年模型后推再分析结果编译的默认风和波数据。如前一节所述，对于16个等角风扇区中的每一个扇区，计算了最高10%的风速、波高和波功率的平均值。如果用户希望使用另一个数据源，我们建议他们使用相同的风和波统计数据(风速、浪高和波功率最高的10%的平均值)，不过他们也可以使用其他统计数据。但是，这些数据必须包含在一个点shapefile中，具有与提供的WW3数据相同的属性表。

通过从用户提供的测深栅格中提取深度值来确定沿取射线的**平均水深**。该模型沿获取射线沿水深栅格像素宽度的间隔插入点，并在每个点提取栅格值。在计算平均深度之前，会忽略正数和nodata值。

如果在沿射线的任何点上都没有找到有效的水深值，则模型将在最后一点周围的一个越来越大的窗口中搜索，直到找到有效的水深值。这就适应了陆地输入矢量(岸上点在此基础上创建)和水深输入栅格之间的空间差异。

.. _海岸脆弱性-风暴:

潜在的风暴潮
^^^^^^^^^^^^^^^

风暴潮高度是风速和风向的函数，但也与风吹过相对浅的地区的时间有关。一般来说，在给定的风暴中，某一地区的海岸线和大陆架边缘之间的距离越长，风暴潮就越高。该模型通过计算从海岸点到大陆架边缘(或到另一个用户指定的水深轮廓线)的距离来估计风暴潮的相对暴露程度。对于墨西哥湾的飓风，与到大陆架等高线的距离相比，更好的浪涌潜力可能约等于海岸线和30米深度等高线之间的距离(Irish和Resio 2010)。

该模型为所有的海岸点指定了一个距离，甚至包括那些因为离内陆太远、被大片陆地保护或位于岛屿的一侧而看起来没有受到浪涌冲击的点。

.. _海岸脆弱性-海平面变化:

海平面变化
^^^^^^^^^^^^^^^^^^^^

如果研究区足够大，海岸线的某些部分可能会或多或少地受到海平面上升(SLR)的影响，无论是从上升或下降的速度，还是从长期观测到的和/或未来预计的海平面上升或下降的净量来看。在海岸脆弱性模型中，海平面上升的空间变化是一个可选参数。

为了将这个变量包含在曝光指数计算中，该模型采用一个点向量，其属性字段包含相关的SLR度量(速率、净上升或可能与沿海淹没有关的任何其他变量)。通过对每个海岸点的两个最近的SLR点的值取加权平均值，将SLR值与海岸点连接。权重是岸边点到SLR点的距离的倒数。


人口
^^^^^^^^^^^^^^^

在估计海岸线受到风暴侵蚀和淹没的风险时，重要的是要考虑到将受到这些海岸灾害影响的人口数量。基于输入人口栅格，海岸脆弱性模型报告了每个海岸点周围用户定义的半径内的平均人口密度(每平方公里人口)。具体来说，该模型取半径内所有非数据人口像素的平均值，并除以的一个种群像素面积(以平方公里为单位)。

输入人口栅格可以包含研究区内任何相关的人口统计指标，而不是严格意义上的总人口。例如，只总结人口中脆弱部分(如老年人或儿童)的人口密度可能很重要。

.. _海岸脆弱性-局限性:


局限性和简化
===============================

除了技术上的局限，曝光指数也有理论上的局限性。一个主要的限制是，在一个地区发生的复杂海岸过程的动态相互作用被过度简化为七个变量和暴露类别的几何平均值。我们没有模拟近岸地区的风暴潮或波场。更重要的是，该模型没有考虑生境的数量和质量，也没有量化生境在减少海岸灾害方面的作用。此外，该模型没有考虑任何水动力或泥沙运输过程:它假定属于同一大地貌暴露类别的区域表现出类似的方式。此外，在所有的研究区域内，曝光程度的得分是相同的；该模型不考虑:ref:`ranking-table` 中不同变量之间的任何相互作用。例如，无论考虑的地点是沙滩还是岩石悬崖，海浪和风的相对暴露都具有相同的权重。此外，在计算最终暴露指数时，仍然考虑了低地貌等级区域前的生物生境的影响。换句话说，我们假设自然生境为受保护的地区提供了免受侵蚀的保护，而不受其地貌分类的影响(如岩石悬崖)。这种限制人为地降低了这些地区的相对脆弱性，并增加了地貌指数高的地区的相对脆弱性。

另一类模型限制与风浪暴露的计算有关。因为我们的目的是为世界上大多数地区的用户提供默认数据，所以我们必须简化计算风浪暴露所需的输入类型。例如，我们在我们提供的WW3风数据库中计算风暴风速，取风速高于90个百分位值的平均值，而不是使用风速的完整时间序列。因此，我们不能完全反映极端事件的影响。此外，我们通过将最近的三个WW3网格点的波浪统计量的加权平均值分配给海岸段来估计暴露在海浪中的情况。这种方法忽略了任何可能发生在近岸区域的二维过程，这可能会改变一个区域的曝光率。

因此，模型输出不能用来量化某一特定海岸位置受到侵蚀和淹没的影响；该模型产生的是定性输出，被设计用于相对大规模的使用。更重要的是，该模型不能预测一个地区对特定风暴或波场的响应，也没有考虑到可能存在于研究区内的任何大规模泥沙输送途径。

.. _海岸脆弱性-数据需求:

数据需求
==========

该模型的运行时高度依赖于所创建的海岸点的数量和**Landmass**多边形中的详细级别。创建的岸点数量取决于AOI的范围和**模型分辨率**。通常，为了快速运行和快速捕获其他错误，明智的做法是从一个简单的陆地块、一个大的模型分辨率和/或一个小的AOI开始建模。然后根据需要调整这些参数。

- :investspec:`coastal_vulnerability workspace_dir`

- :investspec:`coastal_vulnerability aoi_vector_path`

   .. note:: **关于创建AOI的进一步指导:**
     AOI指示模型在这个AOI多边形内的所有**陆地**海岸线上绘制海岸点。在绘制AOI多边形时，确保排除不应该分析的任何部分。

     在准备其他输入数据时，*不* 建议将GIS数据集剪辑到AOI的确切边界。许多模型函数都需要在海岸线周围的一定距离上搜索图层的存在，这就要求数据覆盖范围超出AOI。该模型将根据需要，适当处理大型数据集的所有裁剪和投影。该模型使用AOI的投影区转换其他输入数据的投影。

- :investspec:`coastal_vulnerability model_resolution` 较大的值将产生更少的岸点，但计算时间更快。

- :investspec:`coastal_vulnerability landmass_vector_path` 一个全局的陆块多边形形状文件是默认提供的(Wessel和Smith, 1996)，但其他层可以被替代。

- :investspec:`coastal_vulnerability wwiii_vector_path` 这些变量用于计算每个海岸线段的风浪暴露排名(参见:ref:`cv-Wind` 和:ref:`cv-Wave`) (:ref:`ranking-table`)。如果用户想从自己的数据创建这个文件，在:ref:`cv-appendix-b` 中提供了说明。

- :investspec:`coastal_vulnerability max_fetch_distance` 用于确定海岸点暴露在海浪或当地风驱动的海浪中的程度(详情见:ref:`cv-Wind`)。一个海岸点只有在其周围的某个方向上，当投射出一个最大接收距离长度的光线时，没有陆地板块与之相交时，才会受到海浪能量的影响。

- :investspec:`coastal_vulnerability bathymetry_raster_path` 用于寻找波高和周期计算所需的平均水深(:eq:`WaveFetch`).

- :investspec:`coastal_vulnerability dem_path` 用于计算每个海岸线段的地形等级(:ref:`ranking-table`)。在计算岸边点周围的平均海拔之前，这个输入中的任何负值都被设置为0。

- :investspec:`coastal_vulnerability dem_averaging_radius`

- :investspec:`coastal_vulnerability shelf_contour_vector_path` 它必须在距离研究区域海岸线1500公里以内。

- :investspec:`coastal_vulnerability habitat_table_path`

   列:

   - :investspec:`coastal_vulnerability habitat_table_path.columns.id`
   - :investspec:`coastal_vulnerability habitat_table_path.columns.path` 在下面的示例中，路径列中列出的文件位于与生境表CSV文件相同的文件夹中。路径可以是绝对的，也可以是相对于此CSV文件的。
   - :investspec:`coastal_vulnerability habitat_table_path.columns.rank`
   - :investspec:`coastal_vulnerability habitat_table_path.columns.protection distance (m)` 更多关于如何填写该表的信息请参见:ref:`cv-appendix-b`.


   .. csv-table::
      :file: ../../invest-sample-data/CoastalVulnerability/GrandBahama_Habitats/Natural_Habitats.csv
      :header-rows: 1
      :widths: auto

- :investspec:`coastal_vulnerability geomorphology_vector_path` 用于分配每个海岸线点的地貌排名(:ref:`ranking-table`)。关于如何填写该表的更多信息请参见:ref:`cv-appendix-b`.

  字段:

  - :investspec:`coastal_vulnerability geomorphology_vector_path.fields.rank`

- :investspec:`coastal_vulnerability geomorphology_fill_value` 如果地貌类型只在AOI中的一部分海岸线上被绘制出来，这是很有用的。

- :investspec:`coastal_vulnerability population_raster_path` 用于计算每个海岸点附近的人口密度。默认提供全局人口栅格文件，但可以替换其他人口栅格图层。

- :investspec:`coastal_vulnerability population_radius`

- :investspec:`coastal_vulnerability slr_vector_path`

- :investspec:`coastal_vulnerability slr_field`

.. _海岸脆弱性结果解释: 

结果解释
====================

最终输出
-------------
+ **InVEST-Coastal-Vulnerability-log-2019....txt**

  + 这是InVEST每次运行时生成的日志文件。它详细描述用于运行的输入参数，并记录可能发生的所有错误。如果在community.naturalcapitalproject.org上发布关于模型运行的问题，请务必将此日志文件附加到您的帖子中！ 

+ **coastal_exposure.gpkg**

  + 这个点向量文件包含模型的最终输出。这些点是基于输入模型分辨率、陆地和AOI创建的。本表各列如下: 

    + *exposure* - 这是最终的曝光指数(*EI* in :ref:`exposure-index`)
    + *R\_* - 在:ref:`exposure-index` 列中的所有其他变量都以**R\_** 为前缀。是这些变量的排名(1-5)版本。这些变量的中间产品，在值被归类到1-5级之前，可以在*Intermediate* 文件夹中找到。见下文。
    + *exposure_no_habitats* - 这是与*exposure* 相同的曝光指数，除了它是按*R_hab*为5计算的。换句话说，如果在这一点附近没有保护栖息地，这就是海岸暴露。
    + *habitat_role* - *exposure_no_habitats* 和*exposure* 之间的区别。
    + *population* - (每平方公里人口)如果使用人口输入栅格，这是每个点周围的平均人口密度。

+ **coastal_exposure.csv**

  + 为方便起见，本表格以csv格式提供 **coastal_exposure.gpkg** 的属性表副本。用户可能希望修改或添加此表的列，以便计算自定义场景的暴露指数。

中间输出
--------------------
+ **intermediate_exposure.gpkg**

  + 此点向量包含与**coastal_exposure.gpkg**中相同的海岸点，但是属性表包含变量的中间值，在这些值被归类到1-5级之前。这主要用于调试最终输出中的意外值。变量包括: *wind*, *wave*, *surge*, *relief*。

+ **habitats/habitat_protection.csv**

  + 这个位于*intermediate/habitats* 子文件夹中的CSV文件包含生境图层处理的结果。每一行表示一个海岸点(*shore_id*列可用于将此表链接到其他表格输出)。每个栖息地都有一列。值为**5** 表示没有在生境距离岸边点的*保护距离* 范围内找到生境。小于5的值表示栖息地在靠近岸边点的位置，该值为**生境表** 输入中定义的*rank*。**R_hab** 列是等式:eq:`r_hab` 的结果。

+ **wind_wave/fetch_rays.gpkg**

  + 这个线向量表示在每个海岸点周围向16个方向投射的光线(参见:ref:`cv-Wind`)。查看这些射线有助于理解风和波曝光计算背后的过程，并选择一个适当的**最大获取距离**。

+ **wind_wave/wave_energies.gpkg**

  + 这个点向量包含了所有的岸边点。属性包括波浪曝光计算中的一些中间值(参见:ref:`cv-Wave`)。

    + *E_ocean* : from equation :eq:`Ewo`

    + *E_local* : from equation :eq:`Ewl`

    + *Eo_El_diff* : E_ocean - E_local

    + *max_E_type* : "ocean" or "local": 表示E_ocean和E_local值较大的标签。

    + *maxH_local* : 横过16条射线的波高最大值(公式:eq:`WaveFetch`) 

    + *minH_local* : 横过16条射线的波高的最小值(公式:eq:`WaveFetch`) 

    + *maxT_local* : 穿过16条射线的波周期的最大值(公式:eq:`WaveFetch`) 

    + *minT_local* : 穿过16条射线的波周期的最小值(公式:eq:`WaveFetch`)

  + **intermediate_exposure.csv** 中返回的*wave* 值是每个岸点上*E_ocean* 和*E_local* 的最大值。

+ **wind_wave/fetch_points.gpkg**

  + 这个点向量包含了所有的岸边点。属性包括在风和波暴露计算中使用的WaveWatchIII值。
  + 还包括16列*fdist_* 和*fdepth_*，分别是每个罗盘方向上的获取射线距离和沿射线的平均水深。

+ **geomorphology/shore_points_missing_geomorphology.gpkg**

  + 该向量存储接收到**地貌填充值** 的海岸点，因为在该点的搜索半径内没有发现地貌段。如果有很多点缺少数据，这可能是由于地形或陆地多边形输入的空间不准确造成的。在GIS中编辑其中一个或两个的几何图形可以帮助解决这个问题。

+ **other subdirectories**

  + *intermediate* 文件夹中的其他子目录包含中间数据处理步骤。上面强调了两个中间结果，一般来说，其他的结果并没有特别有用，但对于调试错误可能有用。

+ **_taskgraph_working_dir**

  + 该目录包含模型内部使用的机器可读数据库。


.. _海岸脆弱性附录a: 

附录1：地貌学定义
=====================================

在本附录中，给出了:ref:`ranking-table` 中地貌分类给出的术语的定义。其中一些来自Gornitz等人(1997)和USACE(2002)。

冲积平原
  沿河的平原，由高海拔地区侵蚀的物质沉积而成。

沿岸沙滩
  狭长的沙滩，只有一个山脊，通常前有沙丘。就其最一般的意义而言，屏障指的是沿海岸涨潮上方堆积的沙子或砾石。它可能部分或完全脱离大陆。

海滩
  海滩通常由沙、鹅卵石或巨石组成，它被定义为直接受海浪作用影响的沿海地区的一部分，并被内陆的海崖、沙丘场或永久植被中断。

断崖
  峭壁高、陡的后岸或悬崖

浪蚀海岸
  在海陆交界面有悬崖和其他陡坡变化的海岸。悬崖表明海洋侵蚀，并暗示给定海岸段的泥沙供应很低。悬崖的高度取决于腹地的地形、该地区的岩性和气候。

三角洲
  河口细粒沉积层的堆积。泥沙堆积的速度超过了波浪侵蚀和下沉所能去除的速度。它们与泥滩和盐沼有关。

河口海岸
 潮口河流或淹没的河谷的潮口。通常被定义为包括任何被淡水稀释的半封闭的沿海水域，因此包括大多数海湾。河口受潮汐的影响，沉积速率和潮汐范围，因此三角洲没有堆积。此外，河口与相对低洼的腹地、泥滩和盐沼有关。 

低峡湾
  冰川侵蚀的入口位于低洼的岩石海岸上(其他术语包括入海口，峡湾和三角港)。

峡湾
  海沟狭窄、深、壁陡的入海口，通常由海的入口进入一个很深的冰川槽形成

冰碛
  一个集合术语，包括冰川、融水流和风作用在冰河时代沉积的各种沉积物。

湾形海岸
  岩石海岸有岬和海湾，是不同可蚀性岩石的不同侵蚀的结果。

环礁湖
  由沙岛(如障壁岛)或珊瑚礁与公海隔开的浅水水体。

滩涂
  沿海岸由细泥沙和粘土组成的平坦区域，时而被潮水覆盖或不被潮水覆盖，时而被浅水覆盖。


.. _海岸脆弱性附录b:

附录2：数据来源
========================

该模型需要大规模的地球物理、生物、大气和人口数据。大部分信息可以从过去的调查、气象和海洋设备以及模型提供的默认数据库中收集。在本节中，提出了模型所需的不同数据层的各种来源，并描述了在:ref:`cv-data-needs` 一节中讨论的填充输入接口的方法。

:ref:`DEM <dem>`
----------------

:ref:`Bathymetry <bathymetry>`
------------------------------

陆地的轮廓
----------------
为了估计AOI的曝光指数，该模型需要沿海地区的轮廓。正如在:ref:`cv-data-needs` 部分中提到的，我们提供了一个默认的全局陆地矢量多边形文件。这个由美国国家海洋和大气管理局(NOAA)提供的默认数据集被命名为GSHHS，或全球自洽、分级、高分辨率海岸线（欲了解更多信息，请访问https://www.ngdc.noaa.gov/mgg/shorelines/gshhs.html）。它应该足以代表世界上大多数沿海地区的轮廓。但是，如果这个轮廓满足需求，我们鼓励用户用另一图层来代替它。

地貌
-------------
要计算地貌排名，用户必须提供一个地貌层(参考:ref:`cv-data-needs` 章节)，其中包含分类的线段。该地图应提供位于沿海研究区的地貌特征的位置和类型。对于美国的一些地区，用户可以咨询环境敏感度指数网站https://response.restoration.noaa.gov/oil-and-chemical-spills/oil-spills/environmental-sensitivity-index-esi-maps。如果没有这样的数据库，建议将站点调查信息、航空照片、地质地图或卫星图像(例如使用谷歌或必应地图)的数据库进行数字化。州、县或其他地方的GIS部门也可以免费获得这些数据。

此外，用户必须在地貌层的属性表中设置一个名为“RANK”的字段。模型利用这一点，根据识别出的不同地貌类别分配地貌暴露等级。根据:ref:`ranking-table` 中给出的分类分配曝光等级。所有的等级都应该是数字，从1到5。

生境数据层
------------------
自然生境图层(见:ref:`cv-data-needs` *生境表*)应提供有关:ref:`ranking-table` 中描述的沿海生境的位置和类型信息。默认样例数据目录中的生境层是从名为`Shorezone`的数据库获取的<https://www2.gov.bc.ca/gov/content/data/geographic-data-services>。沙丘数据来自Raincoast Applied Ecology提供的一个未发表的数据集。如果您的研究区域没有这样的数据层，可以从站点调查、航空照片或卫星图像中将其数字化(例如使用谷歌或必应地图)。

一些自然栖息地类型的全球层次(如珊瑚、海草、盐沼和红树林)可从联合国环境规划署-世界海洋中心的海洋数据查看器上获得:https://data.unep-wcmc.org/。请注意这些是粗略的，在任何特定的地方不一定非常详细或准确，但如果没有可用的本地数据，或在寻找更多本地栖息地图层时开始分析，它们是非常有用的。

如:ref:`cv-NatHab` 部分所述，该模型使用方程:eq:`r_hab` 计算海岸线段的自然栖息地暴露等级。

这个公式适用于各种可能的自然生境组合，这项工作的结果显示于下表和图:

.. figure:: ../en/coastal_vulnerability/NatHabRankTable.png
   :align: center
   :figwidth: 500px


保护距离
-------------------
理想情况下，这种距离是基于实证研究和文献综述。由于没有关于栖息地保护海岸线不受海浪影响的距离的发表研究结果，你可以用以下方法估计这个参数。在GIS中查看栖息地图层以及您研究区域的陆地。使用“距离”或“测量”工具，测量你认为足够近的，可以对近岸海岸过程产生影响的海岸线和栖息地之间的距离。最好是进行多次测量，并形成你所在地区的平均可接受距离，这可以作为输入。请记住，这个距离反映了当地的水深状况(在浅海近岸地区，海草床可以向海延伸数公里)，也反映了输入层的空间参考质量。

风浪数据
------------------
模型所需的风浪数据包含在InVEST示例数据中。下面是关于如何创建该数据集的文档。

为了估计风暴露和风生波的重要性，需要在AOI附近测量风统计数据。根据至少5年的数据，该模型要求在16个等角扇区(0度、22.5度等)的每一个扇区中，在研究的扇区附近观测到的第90百分位或更高的风速的平均值，以计算相对暴露指数(REI; Keddy,1982)。也就是说，计算REI时，风速时间序列按降序排序，取最高10%的值，并取其方向。按方向对这个子系列进行排序:所有以16个等角扇区为中心的风速都被分配到该扇区。然后取每个扇区的风速平均值。如果某个扇区没有时间序列的记录，因为只有弱风从那个方向吹来，那么该扇区的平均风速被分配为0。请注意，在模型中，风向是风吹来的方向，而不是吹向的方向。

为了计算来自风的波浪功率和取风特性，该模型需要在16个等角扇区(0度、22.5度等)中每个扇区观测到的风速大于或等于第90百分位的平均值。换句话说，为了计算来自风的波能，按方向对观测到的风速时间序列进行排序:所有以16个等角扇区中的每个扇区为中心的风速都分配到该扇区。然后，对于每个扇区，取最高的10%的观测值的平均值。

如果用户想要提供他们自己的风和波统计数据，而不是依赖于WW3的数据，则必须创建一个带有以下列的点shp文件: 

+ 16个名为**REI_VX**的列，其中X=[0,22,45,67,90,112,135,157,180,202,225,247,270,292,315,337](例如，REI_V0)。计算这些风速值是为了估计每个海岸线段的REI。这些值是最高10%的风速的平均值，分配给以上面列出的角度为中心的16个等角扇区。

+ 16个名为**REI_PCTX**的列，其中X具有与上面列出的相同的值。这16%的值(加起来等于1)对应于以上面列出的主要扇区方向X为中心的最高10%的风速的比例。

+ 16列命名为**WavP_X**，其中X的值与上面列出的相同。这些变量用于估计直接暴露在开阔海洋中的场址的波浪照射。它们是从WW3数据中计算出来的，首先估计记录中所有波浪的波浪功率，然后将这些波浪功率值分成前面定义的16个获取扇区。对于每个扇区，我们通过取前10%值的平均值来计算WavP(参见章节:ref:`cv-Model`)。

+ 16列命名为**WavPPCTX**，其中X具有与上面列出的相同的值。这些变量与*WavP_X*结合使用，以估计直接暴露在开放海洋中的场址的波浪暴露。它们对应于以主扇区方向X为中心的最高10%波能值的比例(见章节:ref:`cv-Model`)。

+ 16个名为**V10PCT_X**的列，其中X的值与上面列出的值相同。这些变量被用来估计获取到的波功率。它们对应的是以主要扇区方向X为中心的最高10%的风速的平均值。

海平面变化
----------------
海平面上升通常用潮汐计来测量。在海平面上升的背景下，潮汐计测量的一个很好的全球数据来源是`Permanent Service for Sea Level <https://www.psmsl.org/>`。本网站对世界各地许多地区的海平面变化数据进行了修正，有时未进行修正。要在沿海脆弱性模型中使用此模型，您必须在GIS中创建一个点数据集，表示潮汐计的位置，并且属性表必须包含至少一个数值字段，其中数值越大表示风险级别越高。


参考文献
==========
Arkema, Katie K., Greg Guannel, Gregory Verutes, Spencer A. Wood, Anne Guerry, Mary Ruckelshaus, Peter Kareiva, Martin Lacayo, and Jessica M. Silver. 2013. Coastal Habitats Shield People and Property from Sea-Level Rise and Storms. Nature Climate Change 3 (10): 913–18. https://www.nature.com/articles/nclimate1944.

Bornhold, B.D., 2008, Projected sea level changes for British Columbia in the 21st century, report for the BC Ministry of Environment.

Bush, D.M.; Neal, W.J.; Young, R.S., and Pilkey, O.H. (1999). Utilization of geoindicators for rapid assessment of coastal-hazard risk and mitigation. Oc. and Coast. Manag., 42.

Center for International Earth Science Information Network (CIESIN), Columbia University; and Centro Internacional de Agricultura Tropical (CIAT) (2005). Gridded Population of the World Version 3 (GPWv3). Palisades, NY: Socioeconomic Data and Applications Center (SEDAC), Columbia University.

Cooper J., and McLaughlin S. (1998). Contemporary multidisciplinary approaches to coastal classification and environmental risk analysis. J. Coastal Res. 14(2):512-524

Gornitz, V. (1990). Vulnerability of the east coast, U.S.A. to future sea level rise. JCR, 9.

Gornitz, V. M., Beaty, T.W., and R.C. Daniels (1997). A coastal hazards database for the U.S. West Coast. ORNL/CDIAC-81, NDP-043C: Oak Ridge National Laboratory, Oak Ridge, Tennessee.

Hammar-Klose and Thieler, E.R. (2001). Coastal Vulnerability to Sea-Level Rise: A Preliminary Database for the U.S. Atlantic, Pacific, and Gulf of Mexico Coasts. U.S. Geological Survey, Digital Data Series DDS-68, 1 CD-ROM

Irish, J.L., and Resio, D.T., "A hydrodynamics-based surge scale for hurricanes," Ocean Eng., Vol. 37(1), 69-81, 2010.

Keddy, P. A. (1982). Quantifying within-lake gradients of wave energy: Interrelationships of wave energy, substrate particle size, and shoreline plants in Axe Lake, Ontario. Aquatic Botany 14, 41-58.

Short AD, Hesp PA (1982). Wave, beach and dune interactions in south eastern Australia. Mar Geol 48:259-284

Tolman, H.L. (2009). User manual and system documentation of WAVEWATCH III version 3.14, Technical Note, U. S. Department of Commerce Nat. Oceanic and Atmosph. Admin., Nat. Weather Service, Nat. Centers for Environmental Pred., Camp Springs, MD.

U.S. Army Corps of Engineers (USACE). 2002. U.S. Army Corps of Engineers Coastal Engineering Manual (CEM) EM 1110-2-1100 Vicksburg, Mississippi.

Wessel, P., and W. H. F. Smith (1996). A Global Self-consistent, Hierarchical, High-resolution Shoreline Database, J. Geophys. Res., 101, #B4, pp. 8741-8743.

World Resources Institute (WRI) (2009). "Value of Coral Reefs & Mangroves in the Caribbean, Economic Valuation Methodology V3.0".

